<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="io.renren.modules.rffss.dao.NfBusinDao">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="io.renren.modules.rffss.entity.NfBusinEntity" id="nfBusinMap">
        <result property="id" column="id"/>
        <result property="btype" column="btype"/>
        <result property="status" column="status"/>
        <result property="rffsspid" column="rffsspId"/>
        <result property="createtime" column="createtime"/>
        <result property="lasttime" column="lasttime"/>
    </resultMap>

        <select id="queryPageIsUserId" resultMap="nfBusinMap">
            select b.*  from nf_busin b
            left join nf_rffssp_user u on u.rffsspid=b.rffsspid
            where u.userid=#{userId}
            order by b.lasttime desc
        </select>

        <select id="queryPage" resultMap="nfBusinMap">
            select b.*  from nf_busin b
            left join nf_rffssp r on r.id=b.rffsspid
            <trim prefix="WHERE" prefixOverrides="AND | OR" >
                <if test="status !=null">
                    and b.status = #{status}
                </if>
                <if test="btype != null and btype.size() > 0">
                    and b.btype in
                    <foreach collection="btype" index="idx" item="a" separator="," open="(" close=")">
                        #{a}
                    </foreach>
                </if>
                <if test="issueorg != null and issueorg.size() > 0">
                    and r.issueorg in
                    <foreach collection="issueorg" index="idx" item="b" separator="," open="(" close=")">
                        #{b}
                    </foreach>
                </if>
            </trim>
          order by b.lasttime desc
        </select>
</mapper>
